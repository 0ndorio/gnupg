#!/bin/sh

. $srcdir/defs.inc || exit 3

#info Checking encryption
for i in $plain_files $data_files ; do
    $GPG --always-trust -e -o x --yes -r "$usrname2" $i
    $GPG -o y --yes x
    cmp $i y || error "$i: mismatch"
done

algos="3des"

if have_cipher_algo "IDEA"; then
   algos="$algos idea"
fi

if have_cipher_algo "CAST5"; then
   algos="$algos cast5"
fi

if have_cipher_algo "BLOWFISH"; then
   algos="$algos blowfish"
fi

if have_cipher_algo "AES"; then
   algos="$algos aes aes192 aes256"
fi

if have_cipher_algo "TWOFISH"; then
   algos="$algos twofish"
fi

for ca in $algos ; do
    for i in $plain_files $data_files ; do
	$GPG --always-trust -e -o x --yes -r "$usrname2" --cipher-algo $ca $i
	$GPG -o y --yes x
	cmp $i y || error "$i: mismatch"
    done
done
